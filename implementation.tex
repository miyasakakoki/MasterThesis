実験から抽出した要件に基づいて、システムを作成した。
要件は以下のとおりである
\begin{itemize}
	\item 機器の現在の状態を一覧して確認することができる\\
		機器の状態については、稼働していない・稼働している・稼働しているがネットワークに繋がっていないの３つ。
	\item 機器の過去の状態を時刻と共に確認・取得することができる\\
		各機器の状態について、いつからいつまで稼働していたのか、容易に確認することができる必要がある。
	\item 機器の停止、再起動を行うことができる\\
		回収に備えて、機器の停止、再起動を行う事ができると良い。
\end{itemize}

\section{システムの構成}
システムの構成は以下のとおりである。
\subsection{想定するIoT機器}

\subsection{監視エージェントの動き}
監視対象となるIoT機器には、開発した監視エージェントが入っているものとし、起動時に自動でエージェントプログラムを起動するよう設定されているものとする。

監視エージェントは、起動後、ログファイルがあるか確認し、あった場合、ログファイルから過去のシーケンス番号を読み出す。
無かった場合、過去のシーケンス番号を0にする。

その後、現在のシーケンス番号を0にする。


監視エージェントは、監視サービスに対し過去のシーケンス番号と現在のシーケンス番号、自身が現在正常である旨のメッセージを送信する。
監視サービスから返答があった場合、受理されたとみなし、現在のシーケンス番号を0にする。
その後、過去のシーケンス番号とログファイルを削除する。
また、返答に停止・再起動のコマンドが含まれていた場合、そのコマンドを実行し終了する。
返答が無かった場合、ネットワークに障害があったとみなし、シーケンス番号をインクリメントし、ログファイルに保存する。
この動きを約1分ごとに繰り返す。

\subsection{サービスの動き}
\subsubsection{監視エージェントからメッセージを受け取った時の動き}
監視エージェントからメッセージを受け取った場合、
DBの末尾がコマンドを示すものであった場合、そのコマンドを変数に記録しておく。
過去のシーケンス番号の数だけ、接続されていなかった旨を、最後に通信があった時刻からDBに格納し、
現在のシーケンス番号の数だけ、接続されていなかった旨を、現在の時刻からさかのぼってDBに格納する。
また、現在の時刻にて機器の状態が正常であった旨をDBに格納する。
最後に、コマンドが格納されている変数の内容と、受理した旨のメッセージを監視エージェントに対し送信する。

\subsubsection{利用者から入力があった場合の動き}


\section{想定するユーザーの定義？}

\section{ユーザーの動き？}
ユーザーの動きは以下のとおりである。
%ユーザーの動きを書く









